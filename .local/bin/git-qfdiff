#!/usr/bin/env bash
"${EDITOR:-vim}" -q <(git diff -U0 "$@" | while read -r LINE; do
{
	if [[ "$LINE" =~ ^\+\+\+\ (.+) ]]; then
		FILENAME="${BASH_REMATCH[1]}"
	fi

	if [[ "$LINE" =~ ^@@.*[+-]([0-9]+)[\ ,][+-]([0-9]+)(.*) ]]; then
		LINE_NUMBER="${BASH_REMATCH[1]}"
		COL_NUMBER="0"
		REST="${BASH_REMATCH[3]}"
		echo "$FILENAME:$LINE_NUMBER:$COL_NUMBER: $REST"
	fi
}; done)
